index=wineventlog sourcetype="WinEventLog:Security" (EventCode=4728 OR EventCode=4729 OR EventCode=4732 OR EventCode=4733 OR EventCode=4746 OR EventCode=4747 OR EventCode=4751 OR EventCode=4752 OR EventCode=4756 OR EventCode=4757 OR EventCode=4761 OR EventCode=4762 OR EventCode=4727 OR EventCode=4730 OR EventCode=4731 OR EventCode=4734 OR EventCode=4735 OR EventCode=4737 OR EventCode=4744 OR EventCode=4745 OR EventCode=4748 OR EventCode=4749 OR EventCode=4750 OR EventCode=4753 OR EventCode=4754 OR EventCode=4755 OR EventCode=4758 OR EventCode=4759 OR EventCode=4760 OR EventCode=4763 OR EventCode=4764) NOT Account_Name=*$ NOT 
    [| inputlookup ldap_emg_group_members.csv 
    | fields user 
    | rename user as src_user] NOT 
    [| inputlookup ldap_emg_group_members.csv 
    | fields user] 
| eval status=if((src_user=="sharepoint_admindev" OR src_user=="sharepoint_admin" OR src_user=="projectdev" OR src_user=="project_admin" OR src_user=="IRISPAdmin" OR src_user=="SharePoint_Admin" OR src_user=="irispreadmin" OR src_user=="sharepoint_Admindev" OR src_user=="SharePoint_AdminDev" AND Group_Name=="IIS_IUSRS"),"Noise","Report") 
| where status="Report" AND Group_Name!="IIS_IUSRS"
| rename src_user as "SourceUser-(RequestingChange)" user as "DestinationUser-(AccountChanged)" 
| table status _time host EventCode name Account_Domain "SourceUser-(RequestingChange)" "DestinationUser-(AccountChanged)" Group_Name 
| sort -_time
